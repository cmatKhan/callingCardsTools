
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A collection of objects and functions to work with calling cards sequencing tools">
      
      
        <meta name="author" content="Chase Mateusiak">
      
      
        <link rel="canonical" href="https://cmatkhan.github.io/callingCardsTools/API/BarcodeParser/yeast/BarcodeCounterQc/">
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-8.5.10">
    
    
      
        <title>BarcodeCounterQc - callingCardsTools Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="callingCardsTools Documentation" class="md-header__button md-logo" aria-label="callingCardsTools Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            callingCardsTools Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              BarcodeCounterQc
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/cmatKhan/callingCardsTools" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    callingCardsTools
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="callingCardsTools Documentation" class="md-nav__button md-logo" aria-label="callingCardsTools Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    callingCardsTools Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cmatKhan/callingCardsTools" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    callingCardsTools
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Home" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../home/changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../home/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../home/license/" class="md-nav__link">
        License
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          File Format Specs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="File Format Specs" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          File Format Specs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../file_format_specs/barcode_details/" class="md-nav__link">
        barcode_details
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../file_format_specs/qbed/" class="md-nav__link">
        qBed
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../file_format_specs/yeast_rank_response/" class="md-nav__link">
        yeast_rank_response
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Alignment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Alignment" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Alignment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Alignment/AlignmentTagger/" class="md-nav__link">
        AlignmentTagger
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Alignment/SummaryParser/" class="md-nav__link">
        SummaryParser
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_3" type="checkbox" id="__nav_3_1_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_3">
          mammals
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="mammals" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_3">
          <span class="md-nav__icon md-icon"></span>
          mammals
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Alignment/mammals/Qbed/" class="md-nav__link">
        Qbed
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Analysis" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_1" type="checkbox" id="__nav_3_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2_1">
          yeast
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="yeast" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_2_1">
          <span class="md-nav__icon md-icon"></span>
          yeast
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_1_1" type="checkbox" id="__nav_3_2_1_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2_1_1">
          read_in_data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="read_in_data" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_2_1_1">
          <span class="md-nav__icon md-icon"></span>
          read_in_data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Analysis/yeast/read_in_data/read_in_data/" class="md-nav__link">
        read_in_data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Analysis/yeast/read_in_data/combine_data/" class="md-nav__link">
        combine_data
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_1_2" type="checkbox" id="__nav_3_2_1_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2_1_2">
          rank_response
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="rank_response" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_2_1_2">
          <span class="md-nav__icon md-icon"></span>
          rank_response
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Analysis/yeast/rank_response/bin_by_binding_rank/" class="md-nav__link">
        bin_by_binding_rank
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Analysis/yeast/rank_response/compute_rank_response/" class="md-nav__link">
        compute_rank_response
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Analysis/yeast/rank_response/create_partitions/" class="md-nav__link">
        create_partitions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Analysis/yeast/rank_response/create_rank_response_table/" class="md-nav__link">
        create_rank_response_table
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Analysis/yeast/rank_response/label_responsive_genes/" class="md-nav__link">
        label_responsive_genes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Analysis/yeast/rank_response/parse_binomtest_results/" class="md-nav__link">
        parse_binomtest_results
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Analysis/yeast/rank_response/validate_config/" class="md-nav__link">
        validate_config
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_1_3" type="checkbox" id="__nav_3_2_1_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2_1_3">
          find_min_responsive
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="find_min_responsive" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_2_1_3">
          <span class="md-nav__icon md-icon"></span>
          find_min_responsive
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Analysis/yeast/find_min_responsive/find_min_responsive/" class="md-nav__link">
        find_min_responsive
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_1_4" type="checkbox" id="__nav_3_2_1_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2_1_4">
          chipexo_promoter_sig
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="chipexo_promoter_sig" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_2_1_4">
          <span class="md-nav__icon md-icon"></span>
          chipexo_promoter_sig
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Analysis/yeast/chipexo_promoter_sig/read_in_chipexo_data/" class="md-nav__link">
        read_in_chipexo_data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Analysis/yeast/chipexo_promoter_sig/chipexo_promoter_sig/" class="md-nav__link">
        chipexo_promoter_sig
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3">
          BarcodeParser
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="BarcodeParser" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          BarcodeParser
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_1" type="checkbox" id="__nav_3_3_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3_1">
          mammals
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="mammals" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_1">
          <span class="md-nav__icon md-icon"></span>
          mammals
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mammals/BarcodeCounterQc/" class="md-nav__link">
        BarcodeCounterQc
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_2" type="checkbox" id="__nav_3_3_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3_2">
          yeast
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="yeast" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_2">
          <span class="md-nav__icon md-icon"></span>
          yeast
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          BarcodeCounterQc
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        BarcodeCounterQc
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter" class="md-nav__link">
    BarcodeQcCounter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter" class="md-nav__link">
    BarcodeQcCounter
  </a>
  
    <nav class="md-nav" aria-label="BarcodeQcCounter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.metrics" class="md-nav__link">
    metrics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.r1_transposon_dict" class="md-nav__link">
    r1_transposon_dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.__add__" class="md-nav__link">
    __add__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.combine" class="md-nav__link">
    combine()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.load" class="md-nav__link">
    load()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.update" class="md-nav__link">
    update()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.write" class="md-nav__link">
    write()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" type="checkbox" id="__nav_3_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_4">
          PeakCalling
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="PeakCalling" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          PeakCalling
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4_1" type="checkbox" id="__nav_3_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_4_1">
          yeast
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="yeast" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_4_1">
          <span class="md-nav__icon md-icon"></span>
          yeast
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4_1_1" type="checkbox" id="__nav_3_4_1_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_4_1_1">
          read_in_data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="read_in_data" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_4_1_1">
          <span class="md-nav__icon md-icon"></span>
          read_in_data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../PeakCalling/yeast/read_in_data/qbed_df_to_pyranges/" class="md-nav__link">
        qbed_df_to_pyranges
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../PeakCalling/yeast/read_in_data/read_in_background_data/" class="md-nav__link">
        read_in_background_data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../PeakCalling/yeast/read_in_data/read_in_chrmap/" class="md-nav__link">
        read_in_chrmap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../PeakCalling/yeast/read_in_data/read_in_experiment_data/" class="md-nav__link">
        read_in_experiment_data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../PeakCalling/yeast/read_in_data/read_in_promoter_data/" class="md-nav__link">
        read_in_promoter_data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../PeakCalling/yeast/read_in_data/relabel_chr_column/" class="md-nav__link">
        relabel_chr_column
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../PeakCalling/yeast/enrichment_vectorized/" class="md-nav__link">
        enrichment_vectorized
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../PeakCalling/yeast/hypergeom_pval_vectorized/" class="md-nav__link">
        hypergeom_pval_vectorized
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../PeakCalling/yeast/poisson_pval_vectorized/" class="md-nav__link">
        poisson_pval_vectorized
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4_1_5" type="checkbox" id="__nav_3_4_1_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_4_1_5">
          call_peaks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="call_peaks" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_4_1_5">
          <span class="md-nav__icon md-icon"></span>
          call_peaks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../PeakCalling/yeast/call_peaks/count_hops/" class="md-nav__link">
        count_hops
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../PeakCalling/yeast/call_peaks/add_metrics/" class="md-nav__link">
        add_metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../PeakCalling/yeast/call_peaks/call_peaks/" class="md-nav__link">
        call_peaks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../PeakCalling/yeast/call_peaks/parse_args/" class="md-nav__link">
        parse_args
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../PeakCalling/yeast/call_peaks/main/" class="md-nav__link">
        main
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_5" type="checkbox" id="__nav_3_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_5">
          QC
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="QC" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          QC
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../QC/create_status_coder/" class="md-nav__link">
        create_status_coder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../QC/StatusFlags/" class="md-nav__link">
        StatusFlags
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_6" type="checkbox" id="__nav_3_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_6">
          Reads
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reads" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_6">
          <span class="md-nav__icon md-icon"></span>
          Reads
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reads/ReadParser/" class="md-nav__link">
        ReadParser
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_7" type="checkbox" id="__nav_3_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_7">
          Resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Resources" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_7">
          <span class="md-nav__icon md-icon"></span>
          Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Resources/" class="md-nav__link">
        Resources
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter" class="md-nav__link">
    BarcodeQcCounter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter" class="md-nav__link">
    BarcodeQcCounter
  </a>
  
    <nav class="md-nav" aria-label="BarcodeQcCounter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.metrics" class="md-nav__link">
    metrics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.r1_transposon_dict" class="md-nav__link">
    r1_transposon_dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.__add__" class="md-nav__link">
    __add__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.combine" class="md-nav__link">
    combine()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.load" class="md-nav__link">
    load()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.update" class="md-nav__link">
    update()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.write" class="md-nav__link">
    write()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/cmatKhan/callingCardsTools/edit/master/docs/API/BarcodeParser/yeast/BarcodeCounterQc.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


  <h1>BarcodeCounterQc</h1>

<div class="doc doc-object doc-module">



<a id="callingcardstools.BarcodeParser.yeast.BarcodeQcCounter"></a>
  <div class="doc doc-contents first">
  
      <p>This module contains the BarcodeQcCounter class, which is used for analyzing
barcode quality control data. The class can process and update barcode metrics,
combine multiple objects, and write the results to output files.</p>
<p>Author: Chase Mateusiak
Date: 2023-05-01</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter" class="doc doc-heading">
          <code>BarcodeQcCounter</code>


<a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>A class for counting and processing barcode quality control data.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>metrics</code></td>
          <td>
                <code><span title="typing.DefaultDict">DefaultDict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A nested defaultdict containing the 
barcode metrics.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>r1_transposon_seq_dict</code></td>
          <td>
                <code><span title="typing.DefaultDict">DefaultDict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A defaultdict storing the R1 
transposon sequences.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>callingcardstools/BarcodeParser/yeast/BarcodeQcCounter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BarcodeQcCounter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class for counting and processing barcode quality control data.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        metrics (DefaultDict): A nested defaultdict containing the </span>
<span class="sd">            barcode metrics.</span>
<span class="sd">        r1_transposon_seq_dict (DefaultDict): A defaultdict storing the R1 </span>
<span class="sd">            transposon sequences.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_metrics</span><span class="p">:</span> <span class="n">DefaultDict</span>
    <span class="n">_r1_transposon_seq_dict</span><span class="p">:</span> <span class="n">DefaultDict</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pickle_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes a BarcodeQcCounter instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            pickle_path (str, optional): Path to a pickled BarcodeQcCounter</span>
<span class="sd">                object. If provided, loads the object from the file.</span>
<span class="sd">                Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            FileNotFoundError: If the provided pickle path does not exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pickle_path</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">pickle_path</span><span class="p">):</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Path to pickle file </span><span class="si">{</span><span class="n">pickle_path</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pickle_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metrics</span> <span class="o">=</span> <span class="n">OuterDefaultDict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_r1_transposon_seq_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">defaultdict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the _metrics attribute.</span>

<span class="sd">        Returns:</span>
<span class="sd">            defaultdict: The _metrics attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metrics</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">r1_transposon_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">defaultdict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the _r1_transposon_seq_dict attribute.</span>

<span class="sd">        Returns:</span>
<span class="sd">            defaultdict: the _r1_transposon_seq_dict attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_r1_transposon_seq_dict</span>

    <span class="c1"># private methods ---------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">_combine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;BarcodeQcCounter&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Combine the metrics from another BarcodeQcCounter object.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (BarcodeQcCounter): Another BarcodeQcCounter object</span>
<span class="sd">                whose metrics will be combined with this object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Combine _metrics dictionaries</span>
        <span class="k">for</span> <span class="n">r1_transposon_edit_dist</span><span class="p">,</span> <span class="n">r1_primer_dict</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">r1_primer_seq</span><span class="p">,</span> <span class="n">r2_transposon_dict</span> <span class="ow">in</span> <span class="n">r1_primer_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">r2_transposon_seq</span><span class="p">,</span> <span class="n">r2_restriction_enzyme_dict</span> <span class="ow">in</span> \
                        <span class="n">r2_transposon_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">r2_restriction_enzyme_name</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> \
                            <span class="n">r2_restriction_enzyme_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metrics</span>
                         <span class="p">[</span><span class="n">r1_transposon_edit_dist</span><span class="p">]</span>
                         <span class="p">[</span><span class="n">r1_primer_seq</span><span class="p">]</span>
                         <span class="p">[</span><span class="n">r2_transposon_seq</span><span class="p">]</span>
                         <span class="p">[</span><span class="n">r2_restriction_enzyme_name</span><span class="p">])</span> <span class="o">+=</span> <span class="n">count</span>

        <span class="c1"># Combine _r1_transposon_seq_dict dictionaries</span>
        <span class="k">for</span> <span class="n">r1_transposon_edit_dist</span><span class="p">,</span> <span class="n">r1_transposon_seq_set</span> <span class="ow">in</span> \
                <span class="n">other</span><span class="o">.</span><span class="n">r1_transposon_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_r1_transposon_seq_dict</span><span class="p">[</span><span class="n">r1_transposon_edit_dist</span><span class="p">]</span>\
                <span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">r1_transposon_seq_set</span><span class="p">)</span>

    <span class="c1"># public methods ----------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a BarcodeQcCounter object from a file using Pickle.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path (str): The file path where the object is stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;loading BarcodeQcCounter object from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_data</span><span class="p">,</span> <span class="n">BarcodeQcCounter</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2"> is not a BarcodeQcCounter object&quot;</span><span class="p">)</span>
            <span class="c1"># copy the data from the loaded object to the current instance</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metrics</span> <span class="o">=</span> <span class="n">file_data</span><span class="o">.</span><span class="n">_metrics</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_r1_transposon_seq_dict</span> <span class="o">=</span> <span class="n">file_data</span><span class="o">.</span><span class="n">_r1_transposon_seq_dict</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span> <span class="n">counters</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;BarcodeQcCounter&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;BarcodeQcCounter&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Combine multiple BarcodeQcCounter objects into a single object.</span>

<span class="sd">        Args:</span>
<span class="sd">            counters (Iterable[BarcodeQcCounter]): An iterable of</span>
<span class="sd">                BarcodeQcCounter objects.</span>

<span class="sd">        Returns:</span>
<span class="sd">            BarcodeQcCounter: A new BarcodeQcCounter object with the</span>
<span class="sd">                combined metrics.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">BarcodeQcCounter</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">counter</span> <span class="ow">in</span> <span class="n">counters</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">_combine</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;BarcodeQcCounter&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BarcodeQcCounter&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add two BarcodeQcCounter objects together with the + operator.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BarcodeQcCounter</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Both objects must be of type &#39;BarcodeQcCounter&#39;&quot;</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">BarcodeQcCounter</span><span class="p">()</span>
        <span class="n">result</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">component_tuple</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
               <span class="n">r1_transposon_edit_dist</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
               <span class="n">r2_restriction_enzyme_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates the metrics with given component and deviation tuples.</span>

<span class="sd">        Args:</span>
<span class="sd">            component_tuple (tuple): A tuple containing R1 primer,</span>
<span class="sd">                R1 transposon, and R2 transposon sequences.</span>
<span class="sd">            r1_transposon_edit_dist (int): The edit distance between the</span>
<span class="sd">                R1 transposon sequence and the expected R1 transposon</span>
<span class="sd">            r2_restriction_enzyme_name (str): The R2 restriction enzyme name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">r1_primer_seq</span><span class="p">,</span>
         <span class="n">r1_transposon_seq</span><span class="p">,</span>
         <span class="n">r2_transposon_seq</span><span class="p">)</span> <span class="o">=</span> <span class="n">component_tuple</span>

        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metrics</span>
         <span class="p">[</span><span class="n">r1_transposon_edit_dist</span><span class="p">]</span>
         <span class="p">[</span><span class="n">r1_primer_seq</span><span class="p">]</span>
         <span class="p">[</span><span class="n">r2_transposon_seq</span><span class="p">]</span>
         <span class="p">[</span><span class="n">r2_restriction_enzyme_name</span><span class="p">])</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_r1_transposon_seq_dict</span><span class="p">[</span><span class="n">r1_transposon_edit_dist</span><span class="p">]</span>\
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">r1_transposon_seq</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_summarize_by_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summarizes the metrics by transcription factor (TF).</span>

<span class="sd">        Args:</span>
<span class="sd">            component_dict (dict): A dictionary containing keys for </span>
<span class="sd">                &#39;tf&#39;, &#39;r1_primers&#39;, and &#39;r2_transposons&#39;, and their </span>
<span class="sd">                respective lists of values.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple: A tuple containing R1 primer summary and R2 </span>
<span class="sd">                transposon summary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#</span>
        <span class="n">r1_primer_summary</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">r2_transposon_summary</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># only iterate over those reads which had an r1 transposon seq</span>
        <span class="c1"># edit distance of n or less</span>

        <span class="c1"># r1_for_given_r2_dict = defaultdict(lambda: defaultdict(set))</span>
        <span class="n">r1_for_given_r2_dict</span> <span class="o">=</span> <span class="n">MiddleDefaultDict1</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r1_transposon_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># first level of iteration is over the r1 primer keys.</span>
            <span class="c1"># The dictionary is a nested dictionary with the keys being</span>
            <span class="c1"># r2_transposon sequences and values another dicitonary with</span>
            <span class="c1"># the restriciton enzyme and count</span>
            <span class="k">for</span> <span class="n">r1_primer_seq</span><span class="p">,</span> <span class="n">r1_primer_dict</span> <span class="ow">in</span> <span class="n">r1_transposon_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># if the r1 primer sequence is the expected sequence</span>
                <span class="c1"># for a given tf, then iterate over the r2 transposon</span>
                <span class="c1"># entries and record the results</span>
                <span class="k">for</span> <span class="n">r2_transposon_seq</span><span class="p">,</span> <span class="n">r2_transposon_seq_dict</span> <span class="ow">in</span> \
                        <span class="n">r1_primer_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="c1"># if the r2_transposon_seq is recognized, then save the</span>
                    <span class="c1"># r1_primer_seq. structure of the dict is:</span>
                    <span class="c1"># {&#39;valid_r2_trans_seq&#39;: set(r1_primer_seq1, ...)}</span>
                    <span class="k">if</span> <span class="n">r2_transposon_seq</span> <span class="ow">in</span> \
                            <span class="n">component_dict</span><span class="p">[</span><span class="s1">&#39;r2_transposon&#39;</span><span class="p">]:</span>
                        <span class="p">(</span><span class="n">r1_for_given_r2_dict</span>
                         <span class="p">[</span><span class="n">i</span><span class="p">]</span>
                         <span class="p">[</span><span class="n">r2_transposon_seq</span><span class="p">]</span>
                         <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">r1_primer_seq</span><span class="p">))</span>
                    <span class="c1"># if the r1_primer_seq is an expected sequence, then</span>
                    <span class="c1"># iterate over the r2_transposon_seq_dict and record the</span>
                    <span class="c1"># results</span>
                    <span class="k">if</span> <span class="n">r1_primer_seq</span> <span class="ow">in</span> <span class="n">component_dict</span><span class="p">[</span><span class="s1">&#39;r1_primer&#39;</span><span class="p">]:</span>
                        <span class="n">r1_primer_index</span> <span class="o">=</span> \
                            <span class="n">component_dict</span><span class="p">[</span><span class="s1">&#39;r1_primer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">r1_primer_seq</span><span class="p">)</span>
                        <span class="n">r2_transposon_target_seq</span> <span class="o">=</span> \
                            <span class="n">component_dict</span><span class="p">[</span><span class="s1">&#39;r2_transposon&#39;</span><span class="p">][</span><span class="n">r1_primer_index</span><span class="p">]</span>
                        <span class="n">edit_dist</span> <span class="o">=</span> \
                            <span class="n">align</span><span class="p">(</span>
                                <span class="n">r2_transposon_seq</span><span class="p">,</span>
                                <span class="n">r2_transposon_target_seq</span><span class="p">)</span>
                        <span class="n">r1_primer_record</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s2">&quot;tf&quot;</span><span class="p">:</span> <span class="n">component_dict</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">][</span><span class="n">r1_primer_index</span><span class="p">],</span>
                            <span class="s2">&quot;r1_primer_seq&quot;</span><span class="p">:</span>
                            <span class="n">component_dict</span><span class="p">[</span><span class="s1">&#39;r1_primer&#39;</span><span class="p">][</span><span class="n">r1_primer_index</span><span class="p">],</span>
                            <span class="s2">&quot;r1_transposon_edit_dist&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
                            <span class="s2">&quot;r2_transposon_seq&quot;</span><span class="p">:</span> <span class="n">r2_transposon_seq</span><span class="p">,</span>
                            <span class="s2">&quot;r2_transposon_edit_dist&quot;</span><span class="p">:</span>
                            <span class="n">edit_dist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;editDistance&quot;</span><span class="p">)}</span>
                        <span class="k">for</span> <span class="n">restriction_enzyme</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> \
                                <span class="n">r2_transposon_seq_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="n">record_copy</span> <span class="o">=</span> <span class="n">r1_primer_record</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                            <span class="n">record_copy</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                                <span class="s1">&#39;restriction_enzyme&#39;</span><span class="p">:</span>
                                <span class="n">restriction_enzyme</span><span class="p">,</span>
                                <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="n">count</span><span class="p">})</span>
                            <span class="n">r1_primer_summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">record_copy</span><span class="p">)</span>

        <span class="c1"># in the second iteration, iterate over only those r1_primer_seqs with</span>
        <span class="c1"># a valid r2_transposon_seq</span>
        <span class="k">for</span> <span class="n">r1_transposon_ed</span><span class="p">,</span> <span class="n">r1_transposon_ed_dict</span> <span class="ow">in</span> \
                <span class="n">r1_for_given_r2_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">r2_transposon_seq</span><span class="p">,</span> <span class="n">r1_primer_seq_set</span> <span class="ow">in</span> \
                    <span class="n">r1_transposon_ed_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># extract the TF and expected r1_primer sequence for this</span>
                <span class="c1"># r2_transposon_seq and TF</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">component_dict</span><span class="p">[</span><span class="s1">&#39;r2_transposon&#39;</span><span class="p">]</span>\
                    <span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">r2_transposon_seq</span><span class="p">)</span>
                <span class="n">tf</span> <span class="o">=</span> <span class="n">component_dict</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
                <span class="n">r1_primer_expected</span> <span class="o">=</span> <span class="n">component_dict</span><span class="p">[</span><span class="s2">&quot;r1_primer&quot;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
                <span class="c1"># iterate over all of the `r1_primer_seq` for this</span>
                <span class="c1"># r2_transposon_seq</span>
                <span class="k">for</span> <span class="n">r1_primer_query</span> <span class="ow">in</span> <span class="n">r1_primer_seq_set</span><span class="p">:</span>
                    <span class="c1"># align the r1_primer to the expected r1_primer for this</span>
                    <span class="c1"># r2_transposon_seq and TF</span>
                    <span class="n">edit_dist</span> <span class="o">=</span> <span class="n">align</span><span class="p">(</span>
                        <span class="n">r1_primer_query</span><span class="p">,</span>
                        <span class="n">r1_primer_expected</span><span class="p">)</span>
                    <span class="c1"># create the base record</span>
                    <span class="n">r2_transposon_record</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;tf&quot;</span><span class="p">:</span> <span class="n">tf</span><span class="p">,</span>
                        <span class="s2">&quot;r2_transposon_seq&quot;</span><span class="p">:</span> <span class="n">r2_transposon_seq</span><span class="p">,</span>
                        <span class="s2">&quot;r1_transposon_edit_dist&quot;</span><span class="p">:</span> <span class="n">r1_transposon_ed</span><span class="p">,</span>
                        <span class="s2">&quot;r1_primer_seq&quot;</span><span class="p">:</span> <span class="n">r1_primer_query</span><span class="p">,</span>
                        <span class="s2">&quot;r1_primer_edit_dist&quot;</span><span class="p">:</span>
                        <span class="n">edit_dist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;editDistance&quot;</span><span class="p">)}</span>
                    <span class="k">for</span> <span class="n">restriction_enzyme</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> \
                        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metrics</span>
                         <span class="p">[</span><span class="n">r1_transposon_ed</span><span class="p">]</span>
                         <span class="p">[</span><span class="n">r1_primer_query</span><span class="p">]</span>
                         <span class="p">[</span><span class="n">r2_transposon_seq</span><span class="p">]</span>
                         <span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                        <span class="c1"># make a copy of the record</span>
                        <span class="n">record_copy</span> <span class="o">=</span> <span class="n">r2_transposon_record</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                        <span class="c1"># add additional restriction enzyme info</span>
                        <span class="n">record_copy</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                            <span class="s1">&#39;restriction_enzyme&#39;</span><span class="p">:</span>
                            <span class="n">restriction_enzyme</span><span class="p">,</span>
                            <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="n">count</span><span class="p">})</span>
                        <span class="n">r2_transposon_summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">record_copy</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">r1_primer_summary</span><span class="p">,</span> <span class="n">r2_transposon_summary</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
              <span class="n">raw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
              <span class="n">component_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
              <span class="n">output_dirpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
              <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;barcode_qc&quot;</span><span class="p">,</span>
              <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a pickle and/or a comma-delimited file summarizing the</span>
<span class="sd">        barcode QC metrics.</span>

<span class="sd">        Args:</span>
<span class="sd">            raw (bool, optional): If True, pickles the object.</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">            component_dict (dict, optional): A dictionary containing keys</span>
<span class="sd">                for &#39;tf&#39;, &#39;r1_primers&#39;, and &#39;r2_transposons&#39;, and their</span>
<span class="sd">                respective lists of values. If provided, writes summaries</span>
<span class="sd">                for each component. Defaults to None.</span>
<span class="sd">            output_dirpath (str, optional): The output directory path where</span>
<span class="sd">                the files will be saved. Defaults to the current directory.</span>
<span class="sd">            filename (str, optional): The base filename for the output files.</span>
<span class="sd">                Defaults to &quot;barcode_qc&quot;.</span>
<span class="sd">            suffix (str, optional): A suffix to be appended to the base</span>
<span class="sd">                filename. Defaults to an empty string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check that the output_dirpath is a valid directory</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dirpath</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;output_dirpath must be a valid directory&quot;</span><span class="p">)</span>
        <span class="c1"># if raw is true, then pickle the object</span>
        <span class="k">if</span> <span class="n">raw</span><span class="p">:</span>
            <span class="n">pickle_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">output_dirpath</span><span class="p">,</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">suffix</span> <span class="o">+</span> <span class="s2">&quot;.pickle&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;pickling barcode_qc object to </span><span class="si">%s{pick_path}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pickle_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pickle_file</span><span class="p">:</span>
                <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pickle_file</span><span class="p">)</span>

        <span class="c1"># if component_dict is passed</span>
        <span class="k">if</span> <span class="n">component_dict</span><span class="p">:</span>
            <span class="c1"># input checks</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;component_dict must be a dictionary&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">{</span><span class="s1">&#39;tf&#39;</span><span class="p">,</span> <span class="s1">&#39;r1_primer&#39;</span><span class="p">,</span> <span class="s1">&#39;r2_transposon&#39;</span><span class="p">}</span> <span class="o">==</span> \
                    <span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">component_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;component_dict must be a dictionary &quot;</span>
                                 <span class="s2">&quot;where the keys are &#39;tf&#39;, &#39;r1_primers&#39;, &quot;</span>
                                 <span class="s2">&quot;&#39;r2_transposons&#39; and the values are &quot;</span>
                                 <span class="s2">&quot;lists of the same length. The index of &quot;</span>
                                 <span class="s2">&quot;each list corresponds to the same &quot;</span>
                                 <span class="s2">&quot;transcription factor.&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">component_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;component_dict values must be lists&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">({</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">component_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()})</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;component_dict values must be lists of &quot;</span>
                                 <span class="s2">&quot;the same length&quot;</span><span class="p">)</span>
            <span class="c1"># extract summaries from the metrics</span>
            <span class="n">r1_primer_summary</span><span class="p">,</span> <span class="n">r2_transposon_summary</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_summarize_by_tf</span><span class="p">(</span><span class="n">component_dict</span><span class="p">)</span>

            <span class="c1"># write r1_primer_summary to file</span>
            <span class="n">append_suffix</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">suffix</span> <span class="k">if</span> <span class="n">suffix</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="n">r1_primer_basename</span> <span class="o">=</span> \
                <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;_r1_primer_summary&quot;</span> <span class="o">+</span> <span class="n">append_suffix</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span>
            <span class="n">r1_primer_summary_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">output_dirpath</span><span class="p">,</span> <span class="n">r1_primer_basename</span><span class="p">)</span>
            <span class="n">r1_primer_summary_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">r1_primer_summary</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;writing r1_primer_summary &quot;</span>
                        <span class="s2">&quot;to </span><span class="si">%s{r1_primer_summary_path}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">r1_primer_summary_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">r1_primer_summary_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="c1"># write r2_transposon summary to file</span>
            <span class="n">r2_transposon_summary_basename</span> <span class="o">=</span> \
                <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;_r2_transposon_summary&quot;</span> <span class="o">+</span> <span class="n">append_suffix</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span>
            <span class="n">r2_transposon_summary_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">output_dirpath</span><span class="p">,</span> <span class="n">r2_transposon_summary_basename</span><span class="p">)</span>
            <span class="n">r2_transposon_summary_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">r2_transposon_summary</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;writing r2_transposon_summary &quot;</span>
                        <span class="s2">&quot;to </span><span class="si">%s{r2_transposon_summary_path}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">r2_transposon_summary_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
                <span class="n">r2_transposon_summary_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h3 id="callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.metrics" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">metrics</span><span class="p">:</span> <span class="n">defaultdict</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.metrics" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the _metrics attribute.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>defaultdict</code></td>          <td>
                <code><span title="collections.defaultdict">defaultdict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The _metrics attribute.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h3 id="callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.r1_transposon_dict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">r1_transposon_dict</span><span class="p">:</span> <span class="n">defaultdict</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.r1_transposon_dict" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the _r1_transposon_seq_dict attribute.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>defaultdict</code></td>          <td>
                <code><span title="collections.defaultdict">defaultdict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the _r1_transposon_seq_dict attribute.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>




<div class="doc doc-object doc-function">




<h3 id="callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.__add__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.__add__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Add two BarcodeQcCounter objects together with the + operator.</p>

          <details class="quote">
            <summary>Source code in <code>callingcardstools/BarcodeParser/yeast/BarcodeQcCounter.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;BarcodeQcCounter&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BarcodeQcCounter&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add two BarcodeQcCounter objects together with the + operator.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BarcodeQcCounter</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Both objects must be of type &#39;BarcodeQcCounter&#39;&quot;</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">BarcodeQcCounter</span><span class="p">()</span>
    <span class="n">result</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">result</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">pickle_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes a BarcodeQcCounter instance.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pickle_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to a pickled BarcodeQcCounter
object. If provided, loads the object from the file.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>FileNotFoundError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the provided pickle path does not exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>callingcardstools/BarcodeParser/yeast/BarcodeQcCounter.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pickle_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes a BarcodeQcCounter instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        pickle_path (str, optional): Path to a pickled BarcodeQcCounter</span>
<span class="sd">            object. If provided, loads the object from the file.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If the provided pickle path does not exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pickle_path</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">pickle_path</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Path to pickle file </span><span class="si">{</span><span class="n">pickle_path</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pickle_path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metrics</span> <span class="o">=</span> <span class="n">OuterDefaultDict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_r1_transposon_seq_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.combine" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">combine</span><span class="p">(</span><span class="n">counters</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.combine" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Combine multiple BarcodeQcCounter objects into a single object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>counters</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter" href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter">BarcodeQcCounter</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An iterable of
BarcodeQcCounter objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>BarcodeQcCounter</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter" href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter">BarcodeQcCounter</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A new BarcodeQcCounter object with the
combined metrics.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>callingcardstools/BarcodeParser/yeast/BarcodeQcCounter.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">combine</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">counters</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;BarcodeQcCounter&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;BarcodeQcCounter&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Combine multiple BarcodeQcCounter objects into a single object.</span>

<span class="sd">    Args:</span>
<span class="sd">        counters (Iterable[BarcodeQcCounter]): An iterable of</span>
<span class="sd">            BarcodeQcCounter objects.</span>

<span class="sd">    Returns:</span>
<span class="sd">        BarcodeQcCounter: A new BarcodeQcCounter object with the</span>
<span class="sd">            combined metrics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">BarcodeQcCounter</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">counter</span> <span class="ow">in</span> <span class="n">counters</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">_combine</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.load" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span></code>

<a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.load" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Load a BarcodeQcCounter object from a file using Pickle.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The file path where the object is stored.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>callingcardstools/BarcodeParser/yeast/BarcodeQcCounter.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a BarcodeQcCounter object from a file using Pickle.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path (str): The file path where the object is stored.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;loading BarcodeQcCounter object from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file_data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_data</span><span class="p">,</span> <span class="n">BarcodeQcCounter</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2"> is not a BarcodeQcCounter object&quot;</span><span class="p">)</span>
        <span class="c1"># copy the data from the loaded object to the current instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metrics</span> <span class="o">=</span> <span class="n">file_data</span><span class="o">.</span><span class="n">_metrics</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_r1_transposon_seq_dict</span> <span class="o">=</span> <span class="n">file_data</span><span class="o">.</span><span class="n">_r1_transposon_seq_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.update" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="n">component_tuple</span><span class="p">,</span> <span class="n">r1_transposon_edit_dist</span><span class="p">,</span> <span class="n">r2_restriction_enzyme_name</span><span class="p">)</span></code>

<a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.update" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Updates the metrics with given component and deviation tuples.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>component_tuple</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple containing R1 primer,
R1 transposon, and R2 transposon sequences.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>r1_transposon_edit_dist</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The edit distance between the
R1 transposon sequence and the expected R1 transposon</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>r2_restriction_enzyme_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The R2 restriction enzyme name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>callingcardstools/BarcodeParser/yeast/BarcodeQcCounter.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
           <span class="n">component_tuple</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
           <span class="n">r1_transposon_edit_dist</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
           <span class="n">r2_restriction_enzyme_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Updates the metrics with given component and deviation tuples.</span>

<span class="sd">    Args:</span>
<span class="sd">        component_tuple (tuple): A tuple containing R1 primer,</span>
<span class="sd">            R1 transposon, and R2 transposon sequences.</span>
<span class="sd">        r1_transposon_edit_dist (int): The edit distance between the</span>
<span class="sd">            R1 transposon sequence and the expected R1 transposon</span>
<span class="sd">        r2_restriction_enzyme_name (str): The R2 restriction enzyme name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">(</span><span class="n">r1_primer_seq</span><span class="p">,</span>
     <span class="n">r1_transposon_seq</span><span class="p">,</span>
     <span class="n">r2_transposon_seq</span><span class="p">)</span> <span class="o">=</span> <span class="n">component_tuple</span>

    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metrics</span>
     <span class="p">[</span><span class="n">r1_transposon_edit_dist</span><span class="p">]</span>
     <span class="p">[</span><span class="n">r1_primer_seq</span><span class="p">]</span>
     <span class="p">[</span><span class="n">r2_transposon_seq</span><span class="p">]</span>
     <span class="p">[</span><span class="n">r2_restriction_enzyme_name</span><span class="p">])</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_r1_transposon_seq_dict</span><span class="p">[</span><span class="n">r1_transposon_edit_dist</span><span class="p">]</span>\
        <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">r1_transposon_seq</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.write" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">write</span><span class="p">(</span><span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">component_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_dirpath</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;barcode_qc&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

<a href="#callingcardstools.BarcodeParser.yeast.BarcodeQcCounter.BarcodeQcCounter.write" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Write a pickle and/or a comma-delimited file summarizing the
barcode QC metrics.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>raw</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, pickles the object.
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>component_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing keys
for &lsquo;tf&rsquo;, &lsquo;r1_primers&rsquo;, and &lsquo;r2_transposons&rsquo;, and their
respective lists of values. If provided, writes summaries
for each component. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>output_dirpath</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The output directory path where
the files will be saved. Defaults to the current directory.</p>
            </div>
          </td>
          <td>
                <code>&#39;.&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The base filename for the output files.
Defaults to &ldquo;barcode_qc&rdquo;.</p>
            </div>
          </td>
          <td>
                <code>&#39;barcode_qc&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>suffix</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A suffix to be appended to the base
filename. Defaults to an empty string.</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>callingcardstools/BarcodeParser/yeast/BarcodeQcCounter.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
          <span class="n">raw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
          <span class="n">component_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
          <span class="n">output_dirpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
          <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;barcode_qc&quot;</span><span class="p">,</span>
          <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write a pickle and/or a comma-delimited file summarizing the</span>
<span class="sd">    barcode QC metrics.</span>

<span class="sd">    Args:</span>
<span class="sd">        raw (bool, optional): If True, pickles the object.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        component_dict (dict, optional): A dictionary containing keys</span>
<span class="sd">            for &#39;tf&#39;, &#39;r1_primers&#39;, and &#39;r2_transposons&#39;, and their</span>
<span class="sd">            respective lists of values. If provided, writes summaries</span>
<span class="sd">            for each component. Defaults to None.</span>
<span class="sd">        output_dirpath (str, optional): The output directory path where</span>
<span class="sd">            the files will be saved. Defaults to the current directory.</span>
<span class="sd">        filename (str, optional): The base filename for the output files.</span>
<span class="sd">            Defaults to &quot;barcode_qc&quot;.</span>
<span class="sd">        suffix (str, optional): A suffix to be appended to the base</span>
<span class="sd">            filename. Defaults to an empty string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check that the output_dirpath is a valid directory</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dirpath</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;output_dirpath must be a valid directory&quot;</span><span class="p">)</span>
    <span class="c1"># if raw is true, then pickle the object</span>
    <span class="k">if</span> <span class="n">raw</span><span class="p">:</span>
        <span class="n">pickle_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">output_dirpath</span><span class="p">,</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">suffix</span> <span class="o">+</span> <span class="s2">&quot;.pickle&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;pickling barcode_qc object to </span><span class="si">%s{pick_path}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pickle_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pickle_file</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pickle_file</span><span class="p">)</span>

    <span class="c1"># if component_dict is passed</span>
    <span class="k">if</span> <span class="n">component_dict</span><span class="p">:</span>
        <span class="c1"># input checks</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;component_dict must be a dictionary&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">{</span><span class="s1">&#39;tf&#39;</span><span class="p">,</span> <span class="s1">&#39;r1_primer&#39;</span><span class="p">,</span> <span class="s1">&#39;r2_transposon&#39;</span><span class="p">}</span> <span class="o">==</span> \
                <span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">component_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;component_dict must be a dictionary &quot;</span>
                             <span class="s2">&quot;where the keys are &#39;tf&#39;, &#39;r1_primers&#39;, &quot;</span>
                             <span class="s2">&quot;&#39;r2_transposons&#39; and the values are &quot;</span>
                             <span class="s2">&quot;lists of the same length. The index of &quot;</span>
                             <span class="s2">&quot;each list corresponds to the same &quot;</span>
                             <span class="s2">&quot;transcription factor.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">component_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;component_dict values must be lists&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">({</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">component_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()})</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;component_dict values must be lists of &quot;</span>
                             <span class="s2">&quot;the same length&quot;</span><span class="p">)</span>
        <span class="c1"># extract summaries from the metrics</span>
        <span class="n">r1_primer_summary</span><span class="p">,</span> <span class="n">r2_transposon_summary</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">_summarize_by_tf</span><span class="p">(</span><span class="n">component_dict</span><span class="p">)</span>

        <span class="c1"># write r1_primer_summary to file</span>
        <span class="n">append_suffix</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">suffix</span> <span class="k">if</span> <span class="n">suffix</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="n">r1_primer_basename</span> <span class="o">=</span> \
            <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;_r1_primer_summary&quot;</span> <span class="o">+</span> <span class="n">append_suffix</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span>
        <span class="n">r1_primer_summary_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">output_dirpath</span><span class="p">,</span> <span class="n">r1_primer_basename</span><span class="p">)</span>
        <span class="n">r1_primer_summary_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">r1_primer_summary</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;writing r1_primer_summary &quot;</span>
                    <span class="s2">&quot;to </span><span class="si">%s{r1_primer_summary_path}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">r1_primer_summary_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">r1_primer_summary_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># write r2_transposon summary to file</span>
        <span class="n">r2_transposon_summary_basename</span> <span class="o">=</span> \
            <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;_r2_transposon_summary&quot;</span> <span class="o">+</span> <span class="n">append_suffix</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span>
        <span class="n">r2_transposon_summary_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">output_dirpath</span><span class="p">,</span> <span class="n">r2_transposon_summary_basename</span><span class="p">)</span>
        <span class="n">r2_transposon_summary_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">r2_transposon_summary</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;writing r2_transposon_summary &quot;</span>
                    <span class="s2">&quot;to </span><span class="si">%s{r2_transposon_summary_path}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">r2_transposon_summary_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
            <span class="n">r2_transposon_summary_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../mammals/BarcodeCounterQc/" class="md-footer__link md-footer__link--prev" aria-label="Previous: BarcodeCounterQc" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              BarcodeCounterQc
            </div>
          </div>
        </a>
      
      
        
        <a href="../../../PeakCalling/yeast/read_in_data/qbed_df_to_pyranges/" class="md-footer__link md-footer__link--next" aria-label="Next: qbed_df_to_pyranges" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              qbed_df_to_pyranges
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": [], "search": "../../../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
    
    
  </body>
</html>